# AgentPay Configuration

# ============ CRITICAL: ENCRYPTION ============
# Generate with: openssl rand -hex 32
# OR: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
AGENTPAY_MASTER_KEY=your-64-character-hex-key-here

# Recommended key rotation:
# AGENTPAY_MASTER_KEY_CURRENT=...
# AGENTPAY_MASTER_KEY_PREVIOUS=...
AGENTPAY_MASTER_KEY_CURRENT=
AGENTPAY_MASTER_KEY_PREVIOUS=

# Optional admin wallet step-up auth (recommended)
ADMIN_WALLET_2FA_REQUIRED=false
ADMIN_WALLET_ADDRESSES=
ADMIN_WALLET_SESSION_MINUTES=15
ADMIN_WALLET_CHALLENGE_TTL_SECONDS=120

# ============ NETWORK ============
BSV_NETWORK=testnet

# ============ API ============
PORT=3100

# ============ CORS ============
# Comma-separated list of allowed origins (production only)
ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com

# ============ PLATFORM WALLET (Optional) ============
# Platform escrow wallet (will be generated if not set)
PLATFORM_WALLET_PRIVKEY=
PLATFORM_WALLET_ADDRESS=

# Escrow mode: platform | multisig
AGENTPAY_ESCROW_MODE=platform

# Required if AGENTPAY_ESCROW_MODE=multisig (2-of-3 buyer/provider/admin)
# Only public key is needed; admin signs tx externally.
AGENTPAY_ADMIN_MULTISIG_PUBKEY=

# ============ DEMO MODE (Development/Testing Only) ============
# When enabled:
# - Uses internal ledger instead of on-chain transactions
# - Allows HTTP endpoints
# - Allows localhost service endpoints
# - Does not require AGENTPAY_MASTER_KEY (uses insecure default)
# - More permissive rate limits
# ⚠️ NEVER use in production!
AGENTPAY_DEMO=true

# Demo mode: Skip authentication (for testing only)
# Allows requests without API key (walletId can be passed in query/body)
# ⚠️ EXTREMELY INSECURE - only for local testing
AGENTPAY_DEMO_SKIP_AUTH=true

# ============ DATABASE ============
# Path to SQLite database (optional)
AGENTPAY_DB=./data/agentpay.db

# ============ PROMPT GUARD ============
PROMPT_GUARD_ENABLED=true
PROMPT_GUARD_WARN_SCORE=25
PROMPT_GUARD_BLOCK_SCORE=60
PROMPT_GUARD_MAX_NODES=1200
PROMPT_GUARD_MAX_STRING_CHARS=2000
PROMPT_GUARD_MAX_AGGREGATE_CHARS=20000
